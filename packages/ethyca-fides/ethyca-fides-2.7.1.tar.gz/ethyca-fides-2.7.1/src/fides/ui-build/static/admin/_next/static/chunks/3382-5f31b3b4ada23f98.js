"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3382],{70783:function(e,r,s){s.d(r,{HK:function(){return a},VY:function(){return t.V}});var t=s(63719),n=s(65698),a=function(){var e=(0,t.V)().errorAlert;return{handleError:function(r){var s="An unexpected error occurred. Please try again.";(0,n.Ot)(r)?s=r.data.detail:(0,n.tB)(r)&&(s=r.data.detail[0].msg),e(s)}}};s(67294)},63719:function(e,r,s){s.d(r,{V:function(){return u}});var t=s(59499),n=s(13450),a=s(26707),i=s(23256),o=s(93225),c=s(85893);function l(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,t)}return s}function d(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?l(Object(s),!0).forEach((function(r){(0,t.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var u=function(){var e=(0,n.pm)();return{errorAlert:function(r,s,t){var n=d(d({},t),{},{position:(null===t||void 0===t?void 0:t.position)||"top",render:function(e){var t=e.onClose;return(0,c.jsxs)(a.bZ,{alignItems:"normal",status:"error",children:[(0,c.jsx)(a.zM,{}),(0,c.jsxs)(i.xu,{children:[s&&(0,c.jsx)(a.Cd,{children:s}),(0,c.jsx)(a.X,{children:r})]}),(0,c.jsx)(o.P,{onClick:t,position:"relative",right:0,size:"sm",top:-1})]})}});null!==t&&void 0!==t&&t.id&&e.isActive(t.id)?e.update(t.id,n):e(n)},successAlert:function(r,s,t){var n=d(d({},t),{},{position:(null===t||void 0===t?void 0:t.position)||"top",render:function(e){var t=e.onClose;return(0,c.jsxs)(a.bZ,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,c.jsx)(a.zM,{}),(0,c.jsxs)(i.xu,{children:[s&&(0,c.jsx)(a.Cd,{children:s}),(0,c.jsx)(a.X,{children:r})]}),(0,c.jsx)(o.P,{onClick:t,position:"relative",right:0,size:"sm",top:-1})]})}});null!==t&&void 0!==t&&t.id&&e.isActive(t.id)?e.update(t.id,n):e(n)}}}},10846:function(e,r,s){s.d(r,{V:function(){return p},t:function(){return u}});var t=s(59499),n=s(23256),a=s(85893);function i(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,t)}return s}function o(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?i(Object(s),!0).forEach((function(r){(0,t.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var c=function(e){var r=e.message;return(0,a.jsxs)(n.xv,{"data-testid":"toast-success-msg",children:[(0,a.jsx)("strong",{children:"Success:"})," ",r]})},l=function(e){var r=e.message;return(0,a.jsxs)(n.xv,{"data-testid":"toast-error-msg",children:[(0,a.jsx)("strong",{children:"Error:"})," ",r]})},d={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},u=function(e){var r=(0,a.jsx)(c,{message:e});return o(o({},d),{description:r})},p=function(e){var r=(0,a.jsx)(l,{message:e});return o(o({},d),{description:r,status:"error"})}},53547:function(e,r,s){s.d(r,{Z:function(){return W}});var t=s(27812),n=s(50029),a=s(16835),i=s(87794),o=s.n(i),c=s(23256),l=s(43894),d=s(12036),u=s(70783),p=s(82175),h=s(41664),m=s.n(h),f=s(11163),j=s(67294),x=s(74231),w=s(18459),b=s(96016),v=x.Z_().required().min(8,"Password must have at least eight characters.").matches(/[0-9]/,"Password must have at least one number.").matches(/[A-Z]/,"Password must have at least one capital letter.").matches(/[a-z]/,"Password must have at least one lowercase letter.").matches(/[\W]/,"Password must have at least one symbol."),g=s(97142),y=s(37161),O=s(59499),P=s(97375),C=s(13450),z=s(26537),S=s(65698),Z=s(10846),k=s(26595),_=s(43072),E=s(85893);function D(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,t)}return s}function V(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?D(Object(s),!0).forEach((function(r){(0,O.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):D(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var q=x.Ry().shape({password:v.label("Password"),passwordConfirmation:x.Z_().required().oneOf([x.iH("password")],"Passwords must match").label("Password confirmation")}),A={password:"",passwordConfirmation:""},R=function(e){var r=function(e){var r=(0,P.qY)(),s=(0,C.pm)(),t=(0,_.ls)(),i=(0,a.Z)(t,1)[0],c=function(){var t=(0,n.Z)(o().mark((function t(n){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({id:e,new_password:n.password});case 2:a=t.sent,(0,k.isErrorResult)(a)?s((0,Z.V)((0,S.e$)(a.error))):(s((0,Z.t)("Successfully reset user's password. Please inform the user of their new password.")),r.onClose());case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return V(V({},r),{},{handleResetPassword:c})}(e.id),s=r.handleResetPassword,t=r.isOpen,i=r.onClose,d=r.onOpen;return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(l.zx,{colorScheme:"primary",size:"sm",onClick:d,"data-testid":"reset-password-btn",children:"Reset password"}),(0,E.jsxs)(z.u_,{isCentered:!0,isOpen:t,onClose:i,children:[(0,E.jsx)(z.ZA,{}),(0,E.jsx)(z.hz,{children:(0,E.jsx)(p.J9,{initialValues:A,validationSchema:q,onSubmit:s,children:function(e){var r=e.isSubmitting,s=e.dirty,t=e.isValid;return(0,E.jsxs)(p.l0,{children:[(0,E.jsx)(z.xB,{children:"Reset Password"}),(0,E.jsx)(z.ol,{}),(0,E.jsx)(z.fe,{children:(0,E.jsxs)(c.Kq,{direction:"column",spacing:4,children:[(0,E.jsx)(c.xv,{mb:2,children:"Choose a new password for this user."}),(0,E.jsx)(b.j0,{name:"password",label:"Password",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol."}),(0,E.jsx)(b.j0,{name:"passwordConfirmation",label:"Confirm Password",placeholder:"********",type:"password",tooltip:"Must match above password."})]})}),(0,E.jsx)(z.mz,{children:(0,E.jsxs)(l.hE,{size:"sm",spacing:"2",width:"100%",children:[(0,E.jsx)(l.zx,{onClick:i,variant:"outline",width:"50%",children:"Cancel"}),(0,E.jsx)(l.zx,{colorScheme:"primary",disabled:!s||!t,isLoading:r,type:"submit",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})})]})}})})]})]})},I=s(27634),N=s(30268);function M(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,t)}return s}function U(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?M(Object(s),!0).forEach((function(r){(0,O.Z)(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):M(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}var F=function(e){var r=function(e){var r=(0,P.qY)(),s=(0,j.useState)(""),t=s[0],i=s[1],c=(0,j.useState)(""),l=c[0],d=c[1],u=(0,_.ev)(),p=(0,a.Z)(u,2),h=p[0],m=p[1].isLoading,f=!!(e&&l&&t),x=function(){var s=(0,n.Z)(o().mark((function s(){return o().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:f&&h({id:e,old_password:t,new_password:l}).unwrap().then((function(){return r.onClose()}));case 1:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}();return U(U({},r),{},{changePasswordValidation:f,handleChange:function(e){"oldPassword"===e.target.name?i(e.target.value):d(e.target.value)},handleChangePassword:x,isLoading:m,newPasswordValue:l,oldPasswordValue:t})}(e.id),s=r.changePasswordValidation,t=r.handleChange,i=r.handleChangePassword,d=r.isLoading,u=r.isOpen,p=r.newPasswordValue,h=r.oldPasswordValue,m=r.onClose,f=r.onOpen;return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(l.zx,{colorScheme:"primary",size:"sm",onClick:f,"data-testid":"update-password-btn",children:"Update Password"}),(0,E.jsxs)(z.u_,{isCentered:!0,isOpen:u,onClose:m,children:[(0,E.jsx)(z.ZA,{}),(0,E.jsxs)(z.hz,{children:[(0,E.jsx)(z.xB,{children:"Update Password"}),(0,E.jsx)(z.ol,{}),(0,E.jsx)(z.fe,{pb:6,children:(0,E.jsxs)(c.Kq,{direction:"column",spacing:"15px",children:[(0,E.jsx)(I.NI,{children:(0,E.jsx)(N.II,{isRequired:!0,name:"oldPassword",onChange:t,placeholder:"Old Password",type:"password",value:h,"data-testid":"input-oldPassword"})}),(0,E.jsx)(I.NI,{children:(0,E.jsx)(N.II,{isRequired:!0,name:"newPassword",onChange:t,placeholder:"New Password",type:"password",value:p,"data-testid":"input-newPassword"})})]})}),(0,E.jsxs)(z.mz,{children:[(0,E.jsx)(l.zx,{bg:"white",marginRight:"10px",onClick:m,size:"sm",variant:"solid",width:"50%",children:"Cancel"}),(0,E.jsx)(l.zx,{bg:"primary.800",color:"white",disabled:!s,isLoading:d,mr:3,onClick:i,size:"sm",type:"submit",variant:"solid",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})]})]})]})},K=function(e){var r,s=e.profileId,t=null==s,n=(0,g.C)(y.dy),a=(0,_.gU)(null!==(r=null===n||void 0===n?void 0:n.id)&&void 0!==r?r:"").data,i=!!n&&n.id===s,o=!!a&&a.scopes.includes("user:password-reset");return t?(0,E.jsx)(b.j0,{name:"password",label:"Password",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol."}):s&&(i||o)?(0,E.jsxs)(c.Ug,{children:[i?(0,E.jsx)(F,{id:s}):null,o?(0,E.jsx)(R,{id:s}):null]}):null},L="privacy-request:read",X={username:"",first_name:"",last_name:"",password:"",scopes:[L]},H=x.Ry().shape({username:x.Z_().required().label("Username"),first_name:x.Z_().label("First name"),last_name:x.Z_().label("Last name"),password:v.label("Password"),scopes:x.IX().of(x.Z_())}),W=function(e){var r=e.onSubmit,s=e.initialValues,i=e.canEditNames,h=e.canChangePassword,x=(0,f.useRouter)(),v=(0,u.HK)().handleError,g=Array.isArray(x.query.id)?x.query.id[0]:x.query.id,y=!(null==g)&&!i,O=(0,_.lD)(),P=(0,a.Z)(O,1)[0],C=function(){var e=(0,n.Z)(o().mark((function e(s){var n,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(s);case 2:if(!("error"in(n=e.sent))){e.next=6;break}return v(n.error),e.abrupt("return");case 6:return a=n.data,i={user_id:a.id,scopes:(0,t.Z)(new Set([].concat((0,t.Z)(s.scopes),[L])))},e.next=10,P(i);case 10:"error"in e.sent||x.push(w.e3);case 12:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),z=h?H:H.omit(["password"]),S=(0,j.useMemo)((function(){return w.GM.map((function(e){return e.scope}))}),[]),Z=(0,j.useCallback)((function(e){e.setFieldValue("scopes",(0,t.Z)(S))}),[S]),k=(0,j.useCallback)((function(e){e.setFieldValue("scopes",[L])}),[]);return(0,E.jsx)(p.J9,{onSubmit:C,initialValues:null!==s&&void 0!==s?s:X,validationSchema:z,children:function(e){return(0,E.jsx)(p.l0,{children:(0,E.jsxs)(c.xu,{maxW:["xs","xs","100%"],width:"100%",children:[(0,E.jsxs)(c.Kq,{mb:8,spacing:6,children:[(0,E.jsxs)(c.Kq,{mb:8,spacing:6,maxWidth:"40%",children:[(0,E.jsx)(b.j0,{name:"username",label:"Username",placeholder:"Enter new username"}),(0,E.jsx)(b.j0,{name:"first_name",label:"First Name",placeholder:"Enter first name of user",disabled:y}),(0,E.jsx)(b.j0,{name:"last_name",label:"Last Name",placeholder:"Enter last name of user",disabled:y}),(0,E.jsx)(K,{profileId:g})]}),(0,E.jsx)(c.iz,{mb:7,mt:7}),(0,E.jsx)(c.X6,{fontSize:"xl",colorScheme:"primary",children:"Permissions"}),(0,E.jsx)(c.xv,{children:"Select permissions to assign to this user"}),(0,E.jsxs)(c.xu,{children:[(0,E.jsx)(l.zx,{variant:"outline",size:"sm",mr:3,onClick:function(){Z(e)},children:"Select all"}),(0,E.jsx)(l.zx,{variant:"outline",size:"sm",onClick:function(){k(e)},children:"Deselect all"})]}),(0,E.jsx)(c.xv,{children:"To apply the changes, click 'Save' below."}),(0,E.jsx)(c.iz,{mb:2,mt:2}),(0,E.jsx)(c.Kq,{spacing:[1,5],direction:"column",children:w.GM.map((function(r){var s=e.values.scopes.indexOf(r.scope)>=0;return(0,E.jsx)(d.XZ,{colorScheme:"purple",onChange:function(){s?e.setFieldValue("scopes",e.values.scopes.filter((function(e){return e!==r.scope}))):e.setFieldValue("scopes",[].concat((0,t.Z)(e.values.scopes),[r.scope]))},id:"scopes-".concat(r.privilege),name:"scopes",isChecked:s,value:r.scope===L?void 0:r.scope,isDisabled:r.scope===L,isReadOnly:r.scope===L,children:r.privilege},r.privilege)}))})]}),(0,E.jsx)(m(),{href:w.e3,passHref:!0,children:(0,E.jsx)(l.zx,{variant:"outline",mr:3,size:"sm",children:"Cancel"})}),(0,E.jsx)(l.zx,{type:"submit",bg:"primary.800",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},colorScheme:"primary",size:"sm",children:"Save"})]})})}})}},33278:function(e,r,s){var t=s(23256),n=s(20440),a=s(41664),i=s.n(a),o=(s(67294),s(17140)),c=s(18459),l=s(85893);r.Z=function(e){var r=e.title,s=e.children;return(0,l.jsxs)(o.Z,{title:"User Management",children:[(0,l.jsxs)(t.X6,{fontSize:"2xl",fontWeight:"semibold",children:["User Management",(0,l.jsx)(t.xu,{mt:2,mb:7,children:(0,l.jsxs)(n.aG,{fontWeight:"medium",fontSize:"sm",children:[(0,l.jsx)(n.gN,{children:(0,l.jsx)(i(),{href:c.e3,passHref:!0,children:(0,l.jsx)(n.At,{href:c.e3,children:"User Management"})})}),(0,l.jsx)(n.gN,{children:(0,l.jsx)(n.At,{href:"#",children:r})})]})})]}),s]})}},26595:function(e,r,s){s.d(r,{isAPIError:function(){return t.Bw},isErrorResult:function(){return t.D4}});var t=s(27396)}}]);