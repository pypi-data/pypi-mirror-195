"use strict";(self.webpackChunk_jupyter_collaboration_extension=self.webpackChunk_jupyter_collaboration_extension||[]).push([[497],{9497:(e,t,o)=>{o.r(t),o.d(t,{default:()=>I});var r,a=o(3031),n=o(6677),s=o(2917),i=o(3806),l=o(5828);!function(e){e.openPath="filebrowser:open-path"}(r||(r={}));const c={id:"@jupyter/collaboration-extension:defaultFileBrowser",provides:n.IDefaultFileBrowser,requires:[n.IFileBrowserFactory,s.ITranslator],optional:[a.IRouter,a.JupyterFrontEnd.ITreeResolver,a.ILabShell,i.ISettingRegistry],activate:async(e,t,o,r,a,n,s)=>{console.debug("@jupyter/collaboration-extension:defaultFileBrowser: activated");const{commands:i}=e,c=o.load("jupyter_collaboration"),u=new l.YDrive(e.serviceManager.user,c);e.serviceManager.contents.addDrive(u);const w=t.createFileBrowser("filebrowser",{auto:!1,restore:!1,driveName:"YDrive"});return d.restoreBrowser(w,i,r,a,n),s&&s.load("@jupyterlab/notebook-extension:tracker").then((e=>{const t=e=>{var t;const o=null==e?void 0:e.get("experimentalEnableDocumentWideUndoRedo").composite;u.sharedModelFactory.setDocumentOptions("notebook",{disableDocumentWideUndoRedo:null===(t=!o)||void 0===t||t})};t(e),e.changed.connect((e=>t(e)))})),w}};var d;!function(e){e.restoreBrowser=async function(e,t,o,a,n){const s="jp-mod-restoring";if(e.addClass(s),!o)return await e.model.restore(e.id),await e.model.refresh(),void e.removeClass(s);const i=async()=>{o.routed.disconnect(i);const l=await(null==a?void 0:a.paths);(null==l?void 0:l.file)||(null==l?void 0:l.browser)?(await e.model.restore(e.id,!1),l.file&&await t.execute(r.openPath,{path:l.file,dontShowBrowser:!0}),l.browser&&await t.execute(r.openPath,{path:l.browser,dontShowBrowser:!0})):(await e.model.restore(e.id),await e.model.refresh()),e.removeClass(s),(null==n?void 0:n.isEmpty("main"))&&t.execute("launcher:create")};o.routed.connect(i)}}(d||(d={}));var u=o(8823),w=o(1361),p=o(3944),v=o(2014),b=o(8050),m=o(3209),h=o(4643),y=o(981),f=o(6493),g=o(7099);const I=[c,{id:"@jupyter/collaboration-extension:userMenu",autoStart:!0,requires:[],provides:w.IUserMenu,activate:e=>{const{commands:t}=e,{user:o}=e.serviceManager;return new w.UserMenu({commands:t,user:o})}},{id:"@jupyter/collaboration-extension:userMenuBar",autoStart:!0,requires:[w.IUserMenu],activate:async(e,t)=>{const{shell:o}=e,{user:r}=e.serviceManager,a=new v.MenuBar({forceItemsPosition:{forceX:!1,forceY:!1},renderer:new w.RendererUserMenu(r)});a.id="jp-UserMenu",r.userChanged.connect((()=>a.update())),a.addMenu(t),o.add(a,"top",{rank:1e3})}},{id:"@jupyter/collaboration-extension:rtcGlobalAwareness",autoStart:!0,requires:[h.IStateDB],provides:w.IGlobalAwareness,activate:(e,t)=>{const{user:o}=e.serviceManager,r=new y.Doc,a=new f.GL(r),n=m.ServerConnection.makeSettings(),s=b.URLExt.join(n.wsUrl,"api/yjs");new g.WebsocketProvider(s,"JupyterLab:globalAwareness",r,{awareness:a});const i=()=>{a.setLocalStateField("user",o.identity)};return o.isReady&&i(),o.ready.then(i).catch((e=>console.error(e))),o.userChanged.connect(i),t.changed.connect((async()=>{var e,o;const r=(null===(o=null===(e=(await t.toJSON())["layout-restorer:data"])||void 0===e?void 0:e.main)||void 0===o?void 0:o.current)||"";r.startsWith("editor")||r.startsWith("notebook")?a.setLocalStateField("current",r):a.setLocalStateField("current",null)})),a}},{id:"@jupyter/collaboration-extension:rtcPanel",autoStart:!0,requires:[w.IGlobalAwareness,s.ITranslator],activate:(e,t,o)=>{const{user:r}=e.serviceManager,a=o.load("jupyter_collaboration"),n=new p.SidePanel;n.id=u.DOMUtils.createDomID(),n.title.icon=p.usersIcon,n.title.caption=a.__("Collaboration"),n.addClass("jp-RTCPanel"),e.shell.add(n,"left",{rank:300});const s=new w.UserInfoPanel(r);s.title.label=a.__("User info"),s.title.caption=a.__("User information"),n.addWidget(s);const i=new w.CollaboratorsPanel(r,t,(t=>{e.commands.execute("docmanager:open",{path:t})}));i.title.label=a.__("Online Collaborators"),n.addWidget(i)}}]}}]);